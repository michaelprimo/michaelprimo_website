<!doctype html>
<head>
	<title>Title ~ js1024</title>
	<meta name="author" content="Author"></meta>
	<meta name="description" content="Short description"></meta>
	<meta name="title" content="Title"></meta>
	<meta charset=utf-8>
</head>
<body id=b>
<canvas id=a></canvas>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
#a { position: relative; display: block;}
.play { position: fixed; top: 50%; left: 50%; transform: translateX(-50%)translateY(-50%); font-size: 30px; font-family: arial, sans-serif; background: #f3f4f5; padding: 15px; border: 2px solid #ddd; border-radius: 5px; }
</style>

<script>

// Entry configuration
// ===================

var title = "Title"; // this will be assigned automatically

// Shim setup and polyfills (do not edit)
// ======================================

// canvas automatically adjusted !
a.width = innerWidth;
a.height = innerHeight;

c = a.getContext("2d"); // no more $type conditional

d = document;
window.AudioContext = window.AudioContext || window.webkitAudioContext;
window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
a.requestPointerLock = a.requestPointerLock || a.mozRequestPointerLock || a.webkitRequestPointerLock;
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
if (typeof OscillatorNode !== 'undefined' && OscillatorNode.prototype) {
  OscillatorNode.prototype.start = OscillatorNode.prototype.start || OscillatorNode.prototype.noteOn;
  OscillatorNode.prototype.stop = OscillatorNode.prototype.stop || OscillatorNode.prototype.noteOff;
}

// Add a start button if sound is present in the code
onload = () => {
  var entry_code = entry.innerText;
  var has_sound = false;
  if(entry_code.includes('eval')){
    try {
      eval(entry_code.replace(/eval\(/g, 'throw(').replace(/eval\`/g, 'throw`'));
    }
    catch(e){
      entry_code = e;
    }
  }
  if(entry_code.includes("AudioContext")||entry_code.includes("Oscillator")||entry_code.includes("speak")||entry_code.includes("play")||entry_code.includes("autoplay")){
    b.insertAdjacentHTML("beforeEnd", "<button class='play' onclick='console.log(entry.innerText);eval(entry.innerText);this.remove()'>PLAY</button>");
  }
  else {
    eval(entry.innerText);
  }
};
console.log(
  a, // canvas
  b, // body
  c, // 2D canvas context
  d  // document
);

</script>

<script type=text id=entry>
// Your entry goes here ðŸ‘‡
// =======================
h=a.height;
w=a.width;
v = h/99;
x = w/2;
y=k=h/9*4;
s = w/99;
f = s/4;
z=p=d=g=j=u=e=1;
r=[],t=[];
n=Math.random;
q="sine"
l="ðŸ‘¾"
  for(i = 0; i<99; i++)
  {
    r[i] = n() * w
    t[i] = n() * h
  }
  
  setInterval(function()
  {
    if(g==1)
    {
    localStorage.e>1?e=localStorage.e:0;
    p>e?localStorage.e=p:0;

    a.width=w;
    c.fillStyle = "#104";
    c.fillRect(0, 0, w, h);
      
    
    for(i = 0; i<99; i++)
    {
      c.font = '1vh serif'
      r[i]+=f
      if(r[i]>=w)r[i]=0
      c.fillText("ðŸŒŸ", r[i], t[i])
    }
    c.font = '6vh serif';
    c.fillText(l, x-v*7, y);
    c.fillStyle = "#fff";
  
    c.fillText(p+"/"+e, x, y);
    

    c.font = '9vh serif';
    c.fillText("ðŸŒ•", j-v*9, k);
      j += s;
      if(j >= w+v*9 || j <= -v*9)
      {
        p++;
        q="triangle";
        u=1;
        d = Math.floor(n() * 4);
        s<0?s=-s+f:s+=f
        d==0||d==1?k = h/9*6:0
        d==2||d==3?k = h/9*4:0
        d==0||d==2?j = -v*6:0
        if(d==1||d==3)
        {
          j = w+v*4
          s = -s
        }
      }
      if(j - x <= v*7 && j - x >= -v*7 && y==k)
      {
        q="sawtooth"
        u=1
        c.fillText("ðŸ’¥", x-v*9, y)
        g=0
      }
      if(u==1)
      {
        m = new AudioContext
        o = m.createOscillator()
        o.type=q
        o.connect(m.destination)
        o.start()
        o.stop(0.1)
        u=0
      }
    }
  }, 33);
  


a.addEventListener('click', function() {
  if(g==1)
  {
    c.fillText("âœ¨", x-v*8, y);
    z==1?y = h/9*6:y=h/9*4;
    z=-z;
    c.fillText(l, x, y);
    q="sine";u=1;
  }
});
// =======================
</script>
</body>