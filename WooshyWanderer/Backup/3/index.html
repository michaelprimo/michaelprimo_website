<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, minimum-scale=1, width=device-width, height=device-height">


</head>
<body>

<canvas id="game" width="240" height="135"></canvas>
<script>

let img = new Image();
img.src = 'Image/Biplane.png';
let angle = 45;
let radians = angle * Math.PI / 180;


img.onload = function() {
  init();
};

let canvas = document.querySelector('canvas');
let ctx = canvas.getContext('2d');
// Keys states (false: key is released / true: key is pressed)
up = right = down = left = false;
let speed = 0;
// Keydown listener
onkeydown = (e) => {
speed = 1;
  // Up (up / W / Z)
  if(e.keyCode == 38 || e.keyCode == 90 || e.keyCode == 87){
    up = true;
  }
  
  // Right (right / D)
  if(e.keyCode == 39 || e.keyCode == 68){
	
    right = true;
  }
  
  // Down (down / S)
  if(e.keyCode == 40 || e.keyCode == 83){
    down = true;
  }
  
  // Left (left / A / Q)
  if(e.keyCode == 37 || e.keyCode == 65 ||e.keyCode == 81){
    left = true;
  }
 
}

// Keyup listener
onkeyup = (e) => {

  // Up
  if(e.keyCode == 38 || e.keyCode == 90 || e.keyCode == 87){
    up = false;
  }
  
  // Right
  else if(e.keyCode == 39 || e.keyCode == 68){
    right = false;
  }
  
  // Down
  else if(e.keyCode == 40 || e.keyCode == 83){
    down = false;
  }
  
  // Left
  else if(e.keyCode == 37 || e.keyCode == 65 || e.keyCode == 81){
    left = false;
  }
  
}

function movePlayer()
{
	if(up==false&&down==false&&right==false&&left==false)
  {
	  speed = 0;
  }
	if(down == true && right == true)
	{
		angle = 325;
	}
	else if(down == true && left == true)
	{
		angle = 225;
	}
	else if(down == true)
	{
		angle = 270;
	}
	else if(up == true && right == true)
	{
		angle = 45;
	}
	else if(up == true && left == true)
	{
		angle = 135;
	}
	else if(up == true)
	{
		angle = 90;
	}
	
	
	else if(right == true)
	{
		angle = 0;

	}
	else if(left == true)
	{
		angle = 180;

	}
	radians = (360 - angle) * Math.PI / 180;
	playerX += Math.cos(radians) * speed;
	playerY += Math.sin(radians) * speed;
}


const scale = 1;
const width = 15;
const height = 15;
const scaledWidth = scale * width;
const scaledHeight = scale * height;
let playerY = canvas.height-height-5;
let playerX = canvas.width/2-8;


function drawFrame(frameX, canvasX, canvasY) {
  ctx.drawImage(img,
                frameX * width, 0, width, height,
                canvasX, canvasY, scaledWidth, scaledHeight);

}

let currentLoopIndex = 0;
let frameCount = 0;

function step() {
	movePlayer();
  frameCount++;
  if (frameCount < 2) {
    window.requestAnimationFrame(step);
    return;
  }
  frameCount = 0;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  var map_position = 0;
	var map = 
	[
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3
	];
	//var colors = ["#EAE1F0","#7E7185","#37313B","#4159CB","#89423F","#F63F4C","#FDBB27","#8D902E","#1D1C1F","#59A7AF"];
	let colors = "#1D1C1F";
	for(let i=0; i<9; i++)
	{
		for(let j=0; j<16; j++)
		{
			ctx.fillStyle = colors;
			ctx.fillRect(j*15,i*15,15,15);
			map_position++;
			if(map_position > colors.length)
			{
				map_position = 0;
			}
		}
	}
let animationFrames = [0,1,2,3,4,3,2,1];
  drawFrame(animationFrames[currentLoopIndex], Math.round(playerX),  Math.round(playerY));
  currentLoopIndex++;
  if (currentLoopIndex >= animationFrames.length) 
  {
    currentLoopIndex = 0;
  }
  window.requestAnimationFrame(step);
}

function init() {
  window.requestAnimationFrame(step);
}


</script>
</body>
</html>
