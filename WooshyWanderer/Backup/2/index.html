<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, minimum-scale=1, width=device-width, height=device-height">


</head>
<body>

<canvas id="game" width="240" height="135"></canvas>
<script>

let img = new Image();
img.src = 'Image/Biplane.png';
img.onload = function() {
  init();
};

let canvas = document.querySelector('canvas');
let ctx = canvas.getContext('2d');
// Keys states (false: key is released / true: key is pressed)
up = right = down = left = false;
let speed = 0;
// Keydown listener
onkeydown = (e) => {
speed = 1;
  // Up (up / W / Z)
  if(e.keyCode == 38 || e.keyCode == 90 || e.keyCode == 87){
    up = true;
  }
  
  // Right (right / D)
  if(e.keyCode == 39 || e.keyCode == 68){
	
    right = true;
  }
  
  // Down (down / S)
  if(e.keyCode == 40 || e.keyCode == 83){
    down = true;
  }
  
  // Left (left / A / Q)
  if(e.keyCode == 37 || e.keyCode == 65 ||e.keyCode == 81){
    left = true;
  }
 
}

// Keyup listener
onkeyup = (e) => {
    //speed = 0;
  // Up
  if(e.keyCode == 38 || e.keyCode == 90 || e.keyCode == 87){
    up = false;
  }
  
  // Right
  if(e.keyCode == 39 || e.keyCode == 68){
    right = false;
  }
  
  // Down
  if(e.keyCode == 40 || e.keyCode == 83){
    down = false;
  }
  
  // Left
  if(e.keyCode == 37 || e.keyCode == 65 || e.keyCode == 81){
    left = false;
  }
}

function movePlayer()
{
	if(up == true)
	{
		playerY -= speed;
	}
	if(up == true && right == true)
	{
		playerY -= speed;
		playerX += speed;
	}
	if(up == true && left == true)
	{
		playerY -= speed;
		playerX -= speed;
	}
	if(down == true)
	{
		playerY += speed;
	}
	if(down == true && right == true)
	{
		playerY += speed;
		playerX += speed;
	}
	if(down == true && left == true)
	{
		playerY += speed;
		playerX -= speed;
	}
	if(right == true)
	{
		playerX += speed;
	}
	if(left == true)
	{
		playerX -= speed;
	}
}

let mouseButton = false;
const scale = 1;
const width = 15;
const height = 15;
const scaledWidth = scale * width;
const scaledHeight = scale * height;
let playerY = canvas.height-height-5;
let playerX = canvas.width/2-width;


function drawFrame(frameX, canvasX, canvasY) {
  ctx.drawImage(img,
                frameX * width, 0, width, height,
                canvasX, canvasY, scaledWidth, scaledHeight);
}

let currentLoopIndex = 0;
let frameCount = 0;

function step() {
	movePlayer();
  frameCount++;
  if (frameCount < 2) {
    window.requestAnimationFrame(step);
    return;
  }
  frameCount = 0;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  var map_position = 0;
	var map = 
	[
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3
	];
	var colors = ["#EAE1F0","#7E7185","#37313B","#1D1C1F","#89423F","#F63F4C","#FDBB27","#8D902E","#4159CB","#59A7AF"];
	for(let i=0; i<9; i++)
	{
		for(let j=0; j<15; j++)
		{
			ctx.fillStyle = colors[map[map_position]];
			ctx.fillRect(j*15,i*15,15,15);
			map_position++;
		}
	}
  drawFrame(currentLoopIndex, playerX, playerY);
  currentLoopIndex++;
  if (currentLoopIndex >= 7) {
    currentLoopIndex = 0;
  }
  window.requestAnimationFrame(step);
}

function init() {
  window.requestAnimationFrame(step);
}


</script>
</body>
</html>
