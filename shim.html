<!doctype html>
<head>
	<title>Title ~ js1024</title>
	<meta name="author" content="Author"></meta>
	<meta name="description" content="Short description"></meta>
	<meta name="title" content="Title"></meta>
	<meta charset=utf-8>
</head>
<body id=b>
<canvas id=a></canvas>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
#a { position: relative; display: block;}
.play { position: fixed; top: 50%; left: 50%; transform: translateX(-50%)translateY(-50%); font-size: 30px; font-family: arial, sans-serif; background: #f3f4f5; padding: 15px; border: 2px solid #ddd; border-radius: 5px; }
</style>

<script>

// Entry configuration
// ===================

var title = "Title"; // this will be assigned automatically

// Shim setup and polyfills (do not edit)
// ======================================

// canvas automatically adjusted !
a.width = innerWidth;
a.height = innerHeight;

c = a.getContext("2d"); // no more $type conditional

d = document;
window.AudioContext = window.AudioContext || window.webkitAudioContext;
window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
a.requestPointerLock = a.requestPointerLock || a.mozRequestPointerLock || a.webkitRequestPointerLock;
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
if (typeof OscillatorNode !== 'undefined' && OscillatorNode.prototype) {
  OscillatorNode.prototype.start = OscillatorNode.prototype.start || OscillatorNode.prototype.noteOn;
  OscillatorNode.prototype.stop = OscillatorNode.prototype.stop || OscillatorNode.prototype.noteOff;
}

// Add a start button if sound is present in the code
onload = () => {
  var entry_code = entry.innerText;
  var has_sound = false;
  if(entry_code.includes('eval')){
    try {
      eval(entry_code.replace(/eval\(/g, 'throw(').replace(/eval\`/g, 'throw`'));
    }
    catch(e){
      entry_code = e;
    }
  }
  if(entry_code.includes("AudioContext")||entry_code.includes("Oscillator")||entry_code.includes("speak")||entry_code.includes("play")||entry_code.includes("autoplay")){
    b.insertAdjacentHTML("beforeEnd", "<button class='play' onclick='console.log(entry.innerText);eval(entry.innerText);this.remove()'>PLAY</button>");
  }
  else {
    eval(entry.innerText);
  }
};
console.log(
  a, // canvas
  b, // body
  c, // 2D canvas context
  d  // document
);

</script>

<script type=text id=entry>
// Your entry goes here ðŸ‘‡
// =======================
let vh = a.height/100;
let pX = a.width/2;
let pY = a.height/10*4;
let f = a.width/400;
console.log(f);
let pB=p=d=rB=g=1;
let eX = -30;
let eY = a.height/10*4;
let eR = 50;
let pR = 100;
let speedX = a.width/100;
let speedY = a.height/100;
let debug = "ðŸ‘¾";
let rX = [];
  let rY = [];
  for(let i = 0; i<50; i++)
  {
    rX[i] = Math.random() * a.width;
    rY[i] = Math.random() * a.height;
  }
loop();

function player()
{
    c.fillStyle = "#1a004c";
    c.fillRect(0, 0, a.width, a.height);
    
    c.font = '6vh';
    c.fillText(debug, pX-vh*7, pY);
    c.fillStyle = "#fff";
    c.font = '10vh';
    c.fillText(p, pX-vh, a.height/2);
}

function star()
{
  for(let i = 0; i<30; i++)
  {
    c.font = '12px serif';
    c.fillText("ðŸŒŸ", rX[i], rY[i]);
  }
  
}

function enemy()
{
    c.fillStyle = "red";
    c.font = '10vh san-serif';
    if(g==1)
    {
      c.fillText("ðŸŒ•", eX-vh*10, eY);
    }
    eX += speedX;
    if(eX >= a.width+vh*9 || eX <= -vh*9)
    {
      p++;
      random();
    }
    if(eX - pX <= 30 && eX - pX >= -30 && pY==eY)
    {
      debug="ðŸ’¥";
      c.font = '6vh san-serif';
      c.fillText(debug, pX-vh*5, pY);
      g=0;
    }
}

function loop()
{
  c.clearRect(0, 0, a.width, a.height);
  //random();
  player();
  star();
  enemy();
  if(g==1){setTimeout(loop, 33);}
  
}

function random()
{
  d = Math.floor(Math.random() * 4);
  console.log(speedX);
  speedX = Math.abs(speedX)+f;
  if(d==0)
  {
    eY = a.height/10*6;
    eX = -vh*6;
  }
  if(d==1)
  {
    eY = a.height/10*6;
    eX = a.width+vh*4;
    speedX = -speedX;
  }
  if(d==2)
  {
    eY = a.height/10*4;
    eX = -vh*6;
  }
  if(d==3)
  {
    eY = a.height/10*4;
    eX = a.width+vh*4;
    speedX = -speedX;
  }
}

a.addEventListener('click', function() {
  if(pB==1)
  {
    pY = a.height/10*6;
    pB=0;
    c.font = '6vh serif';
    c.fillText(debug, pX-vh*5, pY);
  }
  else
  {
    pY = a.height/10*4;
    pB=1;
    c.font = '6vh serif';
    c.fillText(debug, pX-vh*5, pY);
  }
}, false);
// =======================
</script>
</body>